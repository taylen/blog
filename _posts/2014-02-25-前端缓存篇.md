---
layout: post
title: 前端缓存篇
---

{{ page.title }}
=================

<p class="meta">25 Feb 2014 - 关于前端缓存的思考</p>

<h2>浏览器自身缓存策略</h2>
<p style="text-indent:2em;">
	从HTTP1.0到HTTP1.1，目前浏览器通过response header控制缓存的方式一共有四个，Cache-Control:max_age/Expires/Last-Modify/Etag。<br/>
	Cache-Control:max_age=259200，表示从response响应时间算起，缓存多少秒（259200/60/60/24=3天）；Expires是绝对的过期时间，如：Tue, 25 Feb 2014 08:34:37 GMT；<br/>
	Last-Modify是当文件Cache-Control和Expires都过期后，向服务器发送请求（如果本地还有缓存，请求中会加上：IF NOT MODIFY），如果服务器返回304则从本地读取缓存，否则获取服务器返回的最新文件；Etag是实体标签的缩写，根据实体内容生成的一段HASH字符串，可以标识资源状态，当资源文件变化时，Etag也会发生改变，通过检测Etag是否相同来判断文件是否更新。Etag比Last-Modify更精确。
</p>

<p style="text-indent:2em;">
	<h2>前端的存储方式</h2>
	除了浏览器的自身缓存策略，还有哪些方式可以实现前端缓存呢？<br/>
	Cookie UserData sessionStorage localStorage等，从下图可以简单看出浏览器储存方式的变更：<br/>
	<img src="http://pic002.cnblogs.com/images/2011/219983/2011052411382518.jpg" width="600" height="202" /><br/>
	1. Cookie目前所有浏览器都支持，一般Cookie总量不能超过4K，但是可以通过浏览器设置不支持cookie，对于安全性、稳定性要求较高的服务需要考虑；此外Cookie不应大量使用，因为Cookie会在同域下的网络请求中进行传输，消耗网络带宽，最不能接受的是：大量的Cookie会导致请求变慢，尤其是移动端的Web开发，因此Cookie要保持少量，只存储与权限有关的，其他信息不要存储在Cookie中；<br/>
	2. UserData是微软专门为IE在系统中开辟的一块存储空间，IE6/7都支持，单个文件不能超过128K，总量不能超过1024K；UserData实质是一个XML文件，可以通过文件名->属性的方式保存字符串；<br/>
	3. sessionStorage localStorage属于HTML5 Web Storage两种方式，localStorage是没有时间限制的数据存储，sessionStorage是session层的数据存储，用户关系浏览器后，数据会被清空；sessionStorage方法和属性同localStorage一样：setItem/getItem/clear/removeItem/length等；<br/>
	4. localStorage原理上限制总量是5M，但是实际测试中chrome最低只支持2.6M，为了兼容性和性能，尽量不要超过2.6M；localStorage原理上是一直存储在浏览器端，但是清理手机内存后就会被清除（尤其Android的一键清理会清除）
</p>

<p style="text-indent:2em;">
	<h2>利用localStorage缓存JS、HTML或者其他</h2>
	最初，我利用localStorage缓存一些静态的、非敏感的JSON数据，不会或者很少发生更新，如：用户非敏感基础信息、业务固定信息等；
</p>

<p style="text-indent:2em;">
	<h2>利用WebWorker开启多线程</h2>
	
</p>

<p style="text-indent:2em;">
	<h2>哪种缓存更新方案更好？</h2>
	
</p>

<p style="text-indent:2em;">持续更新中...</p>

<p>
	参考网址：<br/>
	<a target="_blank" href="http://www.alloyteam.com/2012/04/sth-about-localstorage/">
		Alloy Team本地存储
	</a><br/>
	<a target="_blank" href="https://www.ibm.com/developerworks/cn/web/1108_zhaifeng_websqldb/">
		基于HTML5的WebSQL Database来构建应用程序
	</a><br/>
	<a target="_blank" href="http://mao.li/tag/userdata/">
		用userdata和localstorage做跨浏览器本地储存
	</a><br/>
	<a target="_blank" href="http://blog.jobbole.com/46599/">
		移动网站性能优化：网页加载技术概览
	</a><br/>
	

</p>

